(()=>{var e={};e.id=234,e.ids=[234],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1454:(e,t,s)=>{"use strict";s.r(t),s.d(t,{patchFetch:()=>v,routeModule:()=>h,serverHooks:()=>b,workAsyncStorage:()=>y,workUnitAsyncStorage:()=>S});var r={};s.r(r),s.d(r,{POST:()=>w});var n=s(6559),a=s(8088),i=s(7719),o=s(2190),l=s(3873),c=s.n(l),u=s(9748),d=s.n(u),p=s(4999),g=s(4366);let f=c().join(process.cwd(),"src","app","api","temp","db.json");async function m(){try{let e=await d().readFile(f,"utf-8");return JSON.parse(e)}catch(e){if("ENOENT"===e.code){await d().mkdir(c().dirname(f),{recursive:!0});let e={users:[],messages:[]};return await d().writeFile(f,JSON.stringify(e,null,2)),e}throw e}}async function x(e){await d().writeFile(f,JSON.stringify(e,null,2))}async function w(e,{params:t}){try{let s=await m(),r=s.messages.find(e=>e.id===t.id);if(r){let n=(0,p.b3)().get("x-forwarded-for")||e.headers.get("host")?.split(":")[0]||"Unknown",a=n.startsWith("::ffff:")?n.substring(7):n;return r.seenBy.includes(a)||(r.seenBy.push(a),await x(s),(0,g.broadcastMessage)({action:"seen",id:t.id,ip:a})),o.NextResponse.json({message:"Seen status updated"},{status:200})}return o.NextResponse.json({message:"Not Found"},{status:404})}catch(e){return console.error("POST seen error:",e),o.NextResponse.json({message:"Internal Server Error"},{status:500})}}let h=new n.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/messages/[id]/seen/route",pathname:"/api/messages/[id]/seen",filename:"route",bundlePath:"app/api/messages/[id]/seen/route"},resolvedPagePath:"/home/user/self-transfer/src/app/api/messages/[id]/seen/route.ts",nextConfigOutput:"",userland:r}),{workAsyncStorage:y,workUnitAsyncStorage:S,serverHooks:b}=h;function v(){return(0,i.patchFetch)({workAsyncStorage:y,workUnitAsyncStorage:S})}},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},4366:(e,t,s)=>{"use strict";async function r(e){return new Response(new ReadableStream({start(t){let s=e=>{try{t.enqueue(`data: ${e}

`)}catch(e){console.error("SSE Error:",e)}};global.clients.add(s),console.log("SSE client connected. Total clients:",global.clients.size),e.signal.addEventListener("abort",()=>{global.clients.delete(s),t.close(),console.log("SSE client disconnected. Total clients:",global.clients.size)})}}),{headers:{"Content-Type":"text/event-stream","Cache-Control":"no-cache",Connection:"keep-alive"}})}function n(e){let t=JSON.stringify(e);for(let e of(console.log(`Broadcasting message to ${global.clients.size} clients.`),global.clients))e(t)}s.r(t),s.d(t,{GET:()=>r,broadcastMessage:()=>n}),global.clients||(global.clients=new Set)},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6487:()=>{},8335:()=>{},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9748:e=>{"use strict";e.exports=require("fs/promises")}};var t=require("../../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[719,580,999],()=>s(1454));module.exports=r})();