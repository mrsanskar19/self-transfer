(()=>{var e={};e.id=688,e.ids=[688],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1620:(e,s,t)=>{"use strict";t.r(s),t.d(s,{patchFetch:()=>S,routeModule:()=>h,serverHooks:()=>y,workAsyncStorage:()=>E,workUnitAsyncStorage:()=>v});var r={};t.r(r),t.d(r,{DELETE:()=>w,GET:()=>x});var n=t(6559),a=t(8088),o=t(7719),i=t(2190),l=t(3873),c=t.n(l),u=t(9748),d=t.n(u),p=t(4366);let g=c().join(process.cwd(),"src","app","api","temp","db.json");async function m(){try{let e=await d().readFile(g,"utf-8");return JSON.parse(e)}catch(e){if("ENOENT"===e.code){await d().mkdir(c().dirname(g),{recursive:!0});let e={users:[],messages:[]};return await d().writeFile(g,JSON.stringify(e,null,2)),e}throw e}}async function f(e){await d().writeFile(g,JSON.stringify(e,null,2))}async function x(e,{params:s}){try{let e=(await m()).messages.find(e=>e.id===s.id);if(e)return i.NextResponse.json(e);return i.NextResponse.json({message:"Not Found"},{status:404})}catch(e){return console.error("GET message error:",e),i.NextResponse.json({message:"Internal Server Error"},{status:500})}}async function w(e,{params:s}){try{let e=await m(),t=e.messages.length;if(e.messages=e.messages.filter(e=>e.id!==s.id),e.messages.length<t)return await f(e),(0,p.broadcastMessage)({action:"delete",id:s.id}),i.NextResponse.json({message:"Message deleted"},{status:200});return i.NextResponse.json({message:"Message not found"},{status:404})}catch(e){return console.error("DELETE message error:",e),i.NextResponse.json({message:"Internal Server Error"},{status:500})}}let h=new n.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/messages/[id]/route",pathname:"/api/messages/[id]",filename:"route",bundlePath:"app/api/messages/[id]/route"},resolvedPagePath:"/home/user/self-transfer/src/app/api/messages/[id]/route.ts",nextConfigOutput:"",userland:r}),{workAsyncStorage:E,workUnitAsyncStorage:v,serverHooks:y}=h;function S(){return(0,o.patchFetch)({workAsyncStorage:E,workUnitAsyncStorage:v})}},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},4366:(e,s,t)=>{"use strict";async function r(e){return new Response(new ReadableStream({start(s){let t=e=>{try{s.enqueue(`data: ${e}

`)}catch(e){console.error("SSE Error:",e)}};global.clients.add(t),console.log("SSE client connected. Total clients:",global.clients.size),e.signal.addEventListener("abort",()=>{global.clients.delete(t),s.close(),console.log("SSE client disconnected. Total clients:",global.clients.size)})}}),{headers:{"Content-Type":"text/event-stream","Cache-Control":"no-cache",Connection:"keep-alive"}})}function n(e){let s=JSON.stringify(e);for(let e of(console.log(`Broadcasting message to ${global.clients.size} clients.`),global.clients))e(s)}t.r(s),t.d(s,{GET:()=>r,broadcastMessage:()=>n}),global.clients||(global.clients=new Set)},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6487:()=>{},8335:()=>{},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9748:e=>{"use strict";e.exports=require("fs/promises")}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[719,580],()=>t(1620));module.exports=r})();